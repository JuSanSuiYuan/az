// std_math_test.az - 数学标准库测试
module test.std_math;

import std.test;
import std.math;

fn test_basic_math() void {
    // 测试绝对值
    test.assert(math.abs_int(-5) == 5, "abs_int(-5) 应该等于 5");
    test.assert(math.abs_int(5) == 5, "abs_int(5) 应该等于 5");
    test.assert(math.abs_f(-3.14) == 3.14, "abs_f(-3.14) 应该等于 3.14");

    // 测试最大值最小值
    test.assert(math.max(3, 5) == 5, "max(3, 5) 应该等于 5");
    test.assert(math.min(3, 5) == 3, "min(3, 5) 应该等于 3");
    test.assert(math.max_float(3.14, 2.71) == 3.14, "max_float(3.14, 2.71) 应该等于 3.14");
    test.assert(math.min_float(3.14, 2.71) == 2.71, "min_float(3.14, 2.71) 应该等于 2.71");

    // 测试范围限制
    test.assert(math.clamp(5, 1, 10) == 5, "clamp(5, 1, 10) 应该等于 5");
    test.assert(math.clamp(0, 1, 10) == 1, "clamp(0, 1, 10) 应该等于 1");
    test.assert(math.clamp(15, 1, 10) == 10, "clamp(15, 1, 10) 应该等于 10");
}

fn test_advanced_math() void {
    // 测试阶乘
    test.assert(math.factorial(0) == 1, "factorial(0) 应该等于 1");
    test.assert(math.factorial(1) == 1, "factorial(1) 应该等于 1");
    test.assert(math.factorial(5) == 120, "factorial(5) 应该等于 120");

    // 测试最大公约数和最小公倍数
    test.assert(math.gcd(12, 18) == 6, "gcd(12, 18) 应该等于 6");
    test.assert(math.lcm(12, 18) == 36, "lcm(12, 18) 应该等于 36");

    // 测试角度转换
    test.assert(math.to_degrees(math.PI) == 180.0, "to_degrees(PI) 应该等于 180");
    test.assert(math.to_radians(180.0) == math.PI, "to_radians(180) 应该等于 PI");

    // 测试符号函数
    test.assert(math.sign(5.0) == 1, "sign(5.0) 应该等于 1");
    test.assert(math.sign(-5.0) == -1, "sign(-5.0) 应该等于 -1");
    test.assert(math.sign(0.0) == 0, "sign(0.0) 应该等于 0");
}

fn test_constants() void {
    // 测试数学常量
    test.assert(math.PI > 3.14 && math.PI < 3.15, "PI 应该约等于 3.14");
    test.assert(math.E > 2.71 && math.E < 2.72, "E 应该约等于 2.71");
    test.assert(math.TAU > 6.28 && math.TAU < 6.29, "TAU 应该约等于 6.28");
}

fn main() void {
    test_basic_math();
    test_advanced_math();
    test_constants();
    test.summary();
}